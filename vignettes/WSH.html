<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>WSH - R package for Within-Sample Heterogeneity Scores</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,mathml,charset=utf-8,html --> 
<meta name="src" content="WSH.tex" /> 
<meta name="date" content="2020-01-08 18:29:00" /> 
<link rel="stylesheet" type="text/css" href="WSH.css" /> 
</head><body 
>
  <div class="maketitle">
                                                                                       

                                                                                       
                                                                                       

                                                                                       
                                                                                       

                                                                                       

<h2 class="titleHead">WSH - R package for Within-Sample
Heterogeneity Scores</h2>
<div class="author" ><span 
class="aer12-x-x-120">Michael Scherer</span></div><br />
<div class="date" ><span 
class="aer12-x-x-120">January 8, 2020</span></div>
</div>
<h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
<div class="tableofcontents">
<span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Introduction</a></span>
<br /><span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Installation</a></span>
<br /><span class="sectionToc" >3 <a 
href="#x1-40003" id="QQ2-1-4">Computing WSH scores</a></span>
<br /> <span class="subsectionToc" >3.1 <a 
href="#x1-50003.1" id="QQ2-1-5">FDRP, qFDRP and PDR</a></span>
<br /> <span class="subsectionToc" >3.2 <a 
href="#x1-60003.2" id="QQ2-1-6">MHL</a></span>
<br /> <span class="subsectionToc" >3.3 <a 
href="#x1-70003.3" id="QQ2-1-7">Epipolymorphism and Entropy</a></span>
<br /><span class="sectionToc" >4 <a 
href="#x1-80004" id="QQ2-1-8">Advanced Conﬁguration</a></span>
<br /> <span class="subsectionToc" >4.1 <a 
href="#x1-90004.1" id="QQ2-1-9">Option settings</a></span>
<br /> <span class="subsectionToc" >4.2 <a 
href="#x1-100004.2" id="QQ2-1-10">Windows troubleshooting</a></span>
<br /> <span class="subsectionToc" >4.3 <a 
href="#x1-110004.3" id="QQ2-1-11">Exporting results to Genome Browser tracks</a></span>
</div>
<!--l. 95--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1 </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 97--><p class="noindent" >This vignette desribes the functionalities included in the WSH R package, which includes the
Within-Sample Heterogeneity Scores FDRP, qFDRP, PDR, MHL, Epipolymorphism and Entropy. The
package is able to compute each of those scores from bisulﬁte sequencing data. Input should be a <span 
class="aeti-10x-x-109">bam</span>
ﬁle that contains reads aligned to a reference genome, preferably the human reference genome version
‘hg38&#x2019;. While PDR, qFDRP and FDRP are independent of the employed mapping tool, Epipolymorphism
and Entropy only support bismark as the aligner. In addition to the aligned reads, the user needs to
                                                                                       

                                                                                       
specify annotation of the sites for which the scores should be computed in either of two ways: <span 
class="aett-10x-x-109">GRanges</span>
(<a 
href="http://bioconductor.org/packages/release/bioc/html/GenomicRanges.html" class="url" ><span 
class="aett-10x-x-109">http://bioconductor.org/packages/release/bioc/html/GenomicRanges.html</span></a>) or <span 
class="aett-10x-x-109">RnBSet</span>
(<a 
href="https://rnbeads.org/" class="url" ><span 
class="aett-10x-x-109">https://rnbeads.org/</span></a>). Here, we only discuss how to use the package. A detailed description of each
of the scores can be found in the corresponding publications.

</p><!--l. 99--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2 </span> <a 
 id="x1-30002"></a>Installation</h3>
<!--l. 101--><p class="noindent" >The package is available from GitHub and can be installed by the following command, given that the
<a 
href="https://cran.r-project.org/web/packages/devtools/index.html" >devtools</a> package is installed:
</p>
<div class="fancyvrb" id="fancyvrb1"><a 
 id="x1-3002r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> if(!requireNamespace(&#x0022;devtools&#x0022;))</span><span 
class="aesltt-10x-x-109"> install.packages(&#x0022;devtools&#x0022;,repos</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> &#x0022;https://cloud.r-project.org/&#x0022;)</span>
<br class="fancyvrb" /><a 
 id="x1-3004r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> devtools::install_github(&#x0022;MPIIComputationalEpigenetics/WSHPackage&#x0022;)</span></div>
<!--l. 109--><p class="indent" >You can test if the package was properly installed by executing one of the examples in the
package:
</p>
<div class="fancyvrb" id="fancyvrb2"><a 
 id="x1-3006r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> library(WSH)</span><br class="fancyvrb" /><a 
 id="x1-3008r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> qfdrp</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> wsh.run.example()</span></div>
<!--l. 115--><p class="noindent" >
</p>
<div class="fancyvrb" id="fancyvrb3"><a 
 id="x1-3010r1"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:27:53</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> STARTED</span><span 
class="aett-10x-x-109"> WSH</span><span 
class="aett-10x-x-109"> score</span><span 
class="aett-10x-x-109"> example</span>
<br class="fancyvrb" /><a 
 id="x1-3012r2"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:27:53</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STARTED</span><span 
class="aett-10x-x-109"> Removing</span><span 
class="aett-10x-x-109"> Sex</span><span 
class="aett-10x-x-109"> chromosomes</span>
<br class="fancyvrb" /><a 
 id="x1-3014r3"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:27:53</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> COMPLETED</span><span 
class="aett-10x-x-109"> Removing</span><span 
class="aett-10x-x-109"> Sex</span><span 
class="aett-10x-x-109"> chromosomes</span>
<br class="fancyvrb" /><a 
 id="x1-3016r4"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:27:54</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STARTED</span><span 
class="aett-10x-x-109"> qFDRP</span><span 
class="aett-10x-x-109"> calculation</span>
<br class="fancyvrb" /><a 
 id="x1-3018r5"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:31</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> COMPLETED</span><span 
class="aett-10x-x-109"> qFDRP</span><span 
class="aett-10x-x-109"> calculation</span>
<br class="fancyvrb" /><a 
 id="x1-3020r6"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:31</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> COMPLETED</span><span 
class="aett-10x-x-109"> WSH</span><span 
class="aett-10x-x-109"> score</span><span 
class="aett-10x-x-109"> example</span></div>
<!--l. 125--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3 </span> <a 
 id="x1-40003"></a>Computing WSH scores</h3>
<!--l. 126--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1 </span> <a 
 id="x1-50003.1"></a>FDRP, qFDRP and PDR</h4>
<!--l. 127--><p class="noindent" >FDRP, qFDRP and PDR do not require any additional tools or scripts and can be computed directly
from your <span 
class="aeti-10x-x-109">bam </span>ﬁle. In this case, the <span 
class="aett-10x-x-109">score </span>argument of the <span 
class="aett-10x-x-109">compute.score </span>function needs to be one of
“fdrp&#x0022;, “qfdrp&#x0022; or “pdr&#x0022;. You need to specify the CpG sites for which the scores should be computed in
either of two forms: <span 
class="aett-10x-x-109">GRanges </span>or <span 
class="aett-10x-x-109">RnBSet</span>.
                                                                                       

                                                                                       
</p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-5002x1"><span 
class="aett-10x-x-109">GRanges: </span>This object should contain the positions of the CpGs for which analysis is to be
conducted. The <span 
class="aett-10x-x-109">GRanges </span>object should contain a single entry for each CpG and only have length
1 for each of the entries. Then you can either run <span 
class="aett-10x-x-109">compute.score.GRanges </span>directly or call the
generic function <span 
class="aett-10x-x-109">compute.score</span>.
<div class="fancyvrb" id="fancyvrb4"><a 
 id="x1-5004r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> example.bam</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> system.file(file.path(&#x0022;extData&#x0022;,&#x0022;small_example.bam&#x0022;),</span>
<br class="fancyvrb" /><a 
 id="x1-5006r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> package=&#x0022;WSH&#x0022;)</span><br class="fancyvrb" /><a 
 id="x1-5008r3"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> example.GRanges</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> GRanges(Rle(rep(&#x0022;chr2&#x0022;,10)),</span>
<br class="fancyvrb" /><a 
 id="x1-5010r4"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> IRanges(start=c(2298361,2298554,2298732,</span>
<br class="fancyvrb" /><a 
 id="x1-5012r5"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> 2298743,2298787,2298792,</span>
<br class="fancyvrb" /><a 
 id="x1-5014r6"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> 2298827,2298884,2298915,2298921),</span>
<br class="fancyvrb" /><a 
 id="x1-5016r7"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> end=c(2298361,2298554,2298732,</span>
<br class="fancyvrb" /><a 
 id="x1-5018r8"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> 2298743,2298787,2298792,</span>
<br class="fancyvrb" /><a 
 id="x1-5020r9"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> 2298827,2298884,2298915,2298921)+1))</span>
<br class="fancyvrb" /><a 
 id="x1-5022r10"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> pdr</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> compute.score(bam.file=example.bam,example.GRanges,score=&#x0022;pdr&#x0022;)</span></div>
<!--l. 143--><p class="noindent" >
</p>
<div class="fancyvrb" id="fancyvrb5"><a 
 id="x1-5024r1"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:31</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.2</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> STARTED</span><span 
class="aett-10x-x-109"> PDR</span><span 
class="aett-10x-x-109"> calculation</span>
<br class="fancyvrb" /><a 
 id="x1-5026r2"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:31</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.2</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STARTED</span><span 
class="aett-10x-x-109"> Removing</span><span 
class="aett-10x-x-109"> Sex</span><span 
class="aett-10x-x-109"> chromosomes</span>
<br class="fancyvrb" /><a 
 id="x1-5028r3"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:31</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.2</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> COMPLETED</span><span 
class="aett-10x-x-109"> Removing</span><span 
class="aett-10x-x-109"> Sex</span><span 
class="aett-10x-x-109"> chromosomes</span>
<br class="fancyvrb" /><a 
 id="x1-5030r4"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2020-01-08</span><span 
class="aett-10x-x-109"> 18:28:45</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1.2</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> STATUS</span><span 
class="aett-10x-x-109"> COMPLETED</span><span 
class="aett-10x-x-109"> PDR</span><span 
class="aett-10x-x-109"> calculation</span></div>
<!--l. 151--><p class="noindent" >This returns a <span 
class="aeti-10x-x-109">data.frame</span>, with the CpG positions (chromosome, start, end) in the ﬁrst columns
and the corresponding score in the last column.
</p>
<div class="fancyvrb" id="fancyvrb6"><a 
 id="x1-5032r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> dim(pdr)</span></div>
<!--l. 156--><p class="noindent" >
</p>
<div class="fancyvrb" id="fancyvrb7"><a 
 id="x1-5034r1"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [1]</span><span 
class="aett-10x-x-109"> 10</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 4</span></div>
<!--l. 159--><p class="noindent" >
</p>
<div class="fancyvrb" id="fancyvrb8"><a 
 id="x1-5036r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> head(pdr)</span></div>
<!--l. 162--><p class="noindent" >
</p>
<div class="fancyvrb" id="fancyvrb9"><a 
 id="x1-5038r1"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chromosome</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> start</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> end</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> PDR</span><br class="fancyvrb" /><a 
 id="x1-5040r2"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 1</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298361</span><span 
class="aett-10x-x-109"> 2298362</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> NaN</span>
<br class="fancyvrb" /><a 
 id="x1-5042r3"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 2</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298554</span><span 
class="aett-10x-x-109"> 2298555</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> NaN</span><br class="fancyvrb" /><a 
 id="x1-5044r4"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 3</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298732</span><span 
class="aett-10x-x-109"> 2298733</span><span 
class="aett-10x-x-109"> 0.2413793</span>
<br class="fancyvrb" /><a 
 id="x1-5046r5"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 4</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298743</span><span 
class="aett-10x-x-109"> 2298744</span><span 
class="aett-10x-x-109"> 0.2372881</span><br class="fancyvrb" /><a 
 id="x1-5048r6"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 5</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298787</span><span 
class="aett-10x-x-109"> 2298788</span><span 
class="aett-10x-x-109"> 0.2337662</span>
<br class="fancyvrb" /><a 
 id="x1-5050r7"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 6</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> chr2</span><span 
class="aett-10x-x-109"> 2298792</span><span 
class="aett-10x-x-109"> 2298793</span><span 
class="aett-10x-x-109"> 0.2337662</span></div>
</li>
<li 
  class="enumerate" id="x1-5052x2"><span 
class="aebx-10x-x-109">RnBSet: </span>In addition to <span 
class="aett-10x-x-109">GRanges </span>objects, the WSH package supports <span 
class="aett-10x-x-109">RnBSet </span>objects as input.
Here, the annotation is inferred from the object&#x2019;s annotation. Furthermore, a coverage ﬁltering
step is executed, which ﬁlters sites with coverage lower than <span 
class="aeti-10x-x-109">coverage.threhold </span>in the <span 
class="aett-10x-x-109">RnBSet</span>
object, given such information is present. For more details on how to set options for analysis, see
<a 
href="#x1-90004.1">subsection 4.1</a>.
                                                                                       

                                                                                       
<div class="fancyvrb" id="fancyvrb10"><a 
 id="x1-5054r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> example.rnb.set</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> system.file(file.path(&#x0022;extData&#x0022;,&#x0022;small_rnbSet.zip&#x0022;),</span>
<br class="fancyvrb" /><a 
 id="x1-5056r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> package=&#x0022;WSH&#x0022;)</span><br class="fancyvrb" /><a 
 id="x1-5058r3"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> example.rnb.set</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> load.rnb.set(example.rnb.set)</span>
<br class="fancyvrb" /><a 
 id="x1-5060r4"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> set.option(coverage.threshold</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> 10)</span><br class="fancyvrb" /><a 
 id="x1-5062r5"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> fdrp</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> rnb.calculate.fdrp(example.rnb.set,example.bam)</span>
<br class="fancyvrb" /><a 
 id="x1-5064r6"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> to.plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> data.frame(qFDRP=qfdrp$qFDRP,FDRP=fdrp$FDRP)</span><br class="fancyvrb" /><a 
 id="x1-5066r7"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> to.plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> melt(to.plot)</span>
<br class="fancyvrb" /><a 
 id="x1-5068r8"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> ggplot(to.plot,aes(x=value,y=..count..,fill=variable))+</span>
<br class="fancyvrb" /><a 
 id="x1-5070r9"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> geom_histogram()+facet_grid(variable~.)+theme_bw()</span><br class="fancyvrb" /><a 
 id="x1-5072r10"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> plot</span></div>
</li></ol>

<!--l. 190--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.2 </span> <a 
 id="x1-60003.2"></a>MHL</h4>
<!--l. 191--><p class="noindent" >In contrast to the scores above, MHL requires a working version of <span 
class="aett-10x-x-109">perl </span>installed on your machine. For
Linux systems, this should in general be <span 
class="aett-10x-x-109">/usr/bin/perl</span>, which is per default set in this package. In
case you are using MacOS (we do not support Windows, see <a 
href="#x1-100004.2">subsection 4.2</a>), you ﬁrst need to specify
the option <span 
class="aeti-10x-x-109">perl.path</span>. Furthermore, a working version of <span 
class="aett-10x-x-109">samtools </span>is required by the programs that
compute MHL.
</p>
<div class="fancyvrb" id="fancyvrb11"><a 
 id="x1-6002r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> set.option(perl.path</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> &#x0022;/usr/bin/perl&#x0022;)</span><br class="fancyvrb" /><a 
 id="x1-6004r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> set.option(samtools.path</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> &#x0022;/usr/bin/&#x0022;)</span>
<br class="fancyvrb" /><a 
 id="x1-6006r3"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> mhl</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> compute.score.rnb(bam.file</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> example.bam,</span>
<br class="fancyvrb" /><a 
 id="x1-6008r4"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> rnb.set</span><span 
class="aesltt-10x-x-109"> =</span><span 
class="aesltt-10x-x-109"> example.rnb.set,</span><span 
class="aesltt-10x-x-109"> score=&#x0022;mhl&#x0022;)</span></div>
<!--l. 201--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.3 </span> <a 
 id="x1-70003.3"></a>Epipolymorphism and Entropy</h4>
<!--l. 202--><p class="noindent" >Epipolymorphism and Entropy calculations depend on the methclone software
(<a 
href="https://code.google.com/archive/p/methclone/" class="url" ><span 
class="aett-10x-x-109">https://code.google.com/archive/p/methclone/</span></a>) to compute epiallele counts and then uses R
functions to compute the ﬁnal scores. This package comes with an executable version of methclone and
has been tested for several Debian versions. If you have trouble with the methclone version,
please contact <a 
href="mailto:mscherer@mpi-inf.mpg.de" >the author</a>. In contrast to the scores discussed above, Epipolymorphism and
Entropy do not require an annotation object (either <span 
class="aett-10x-x-109">GRanges </span>or <span 
class="aett-10x-x-109">RnBSet</span>), since methclone
operates as a black box and produces scores at positions directly inferred from the <span 
class="aeti-10x-x-109">bam</span>
ﬁle.
</p>
<div class="fancyvrb" id="fancyvrb12"><a 
 id="x1-7002r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> epipoly</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> compute.score(example.bam,score=&#x0022;epipolymorphism&#x0022;)</span>
<br class="fancyvrb" /><a 
 id="x1-7004r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> entropy</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> compute.score(example.bam,score=&#x0022;entropy&#x0022;)</span>
<br class="fancyvrb" /><a 
 id="x1-7006r3"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> to.plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> data.frame(Epipolymorphism=epipoly$Epipolymorphism,</span>
<br class="fancyvrb" /><a 
 id="x1-7008r4"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> Entropy=entropy$Entropy)</span><br class="fancyvrb" /><a 
 id="x1-7010r5"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> to.plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> melt(to.plot)</span>
<br class="fancyvrb" /><a 
 id="x1-7012r6"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> plot</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> ggplot(to.plot,aes(x=value,y=..density..,color=variable))+</span><br class="fancyvrb" /><a 
 id="x1-7014r7"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> geom_density()+theme_bw()</span><br class="fancyvrb" /><a 
 id="x1-7016r8"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> plot</span></div>
                                                                                       

                                                                                       
<!--l. 216--><p class="noindent" >
</p>
  <h3 class="sectionHead"><span class="titlemark">4  </span> <a 
 id="x1-80004"></a>Advanced Conﬁguration</h3>
<!--l. 217--><p class="noindent" >
</p>
  <h4 class="subsectionHead"><span class="titlemark">4.1  </span> <a 
 id="x1-90004.1"></a>Option settings</h4>
<!--l. 219--><p class="noindent" >The WSH package provides several options, which inﬂuence how the data is handled. This includes
setting coverage thresholds on the annotation, distances between individual CpGs, or quality
thresholds on reads to be considered in the calculation. For a detailed description of each of the
options, see the R documentation or the <a 
href="../man/ISH.pdf" >reference manual</a>.
</p>
  <div class="fancyvrb" id="fancyvrb13"><a 
 id="x1-9002r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> ?set.option</span></div>
<!--l. 226--><p class="noindent" >
</p>
  <h4 class="subsectionHead"><span class="titlemark">4.2  </span> <a 
 id="x1-100004.2"></a>Windows troubleshooting</h4>
<!--l. 228--><p class="noindent" >qFDRP, FDRP and PDR are the only scores supported on Windows machines, since they do not rely
on external tools. In contrast, MHL depends on both <span 
class="aett-10x-x-109">perl </span>and <span 
class="aett-10x-x-109">samtools</span>, and since <span 
class="aett-10x-x-109">samtools </span>is not
easily installable on a Windows machine, we MHL cannot be computed on a Windows machine.
Epipolymorphism and Entropy depend on the methclone software, which is not supported for Windows
and we thus also not support it here.
</p><!--l. 230--><p class="noindent" >
</p>
  <h4 class="subsectionHead"><span class="titlemark">4.3  </span> <a 
 id="x1-110004.3"></a>Exporting results to Genome Browser tracks</h4>
<!--l. 231--><p class="noindent" >We provide a function to export the results as a Genome Browser track. WSH scores can either be
aggregated over genomic bins (parameters <span 
class="aett-10x-x-109">bin.width</span>, default = 5kb) or exported in single CpG
format. The package will output a BED ﬁle with the information on the output generated with
<span 
class="aett-10x-x-109">compute.score</span>.
</p>
  <div class="fancyvrb" id="fancyvrb14"><a 
 id="x1-11002r1"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> create.genomebrowser.track(score.output=qfdrp,</span>
<br class="fancyvrb" /><a 
 id="x1-11004r2"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> +</span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> bin.width=7500,sample.name=&#x0022;mySample&#x0022;)</span>
<br class="fancyvrb" /><a 
 id="x1-11006r3"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> bed.file</span><span 
class="aesltt-10x-x-109"> &#x003C;-</span><span 
class="aesltt-10x-x-109"> readLines(&#x0022;mySample_qFDRP.bed&#x0022;)</span><br class="fancyvrb" /><a 
 id="x1-11008r4"></a><span 
class="aesltt-10x-x-109"> </span><span 
class="aesltt-10x-x-109"> &#x003E;</span><span 
class="aesltt-10x-x-109"> head(bed.file)</span></div>
<!--l. 239--><p class="noindent" >
</p>
                                                                                       

                                                                                       
<div class="fancyvrb" id="fancyvrb15"><a 
 id="x1-11010r1"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [1]</span><span 
class="aett-10x-x-109"> &#x0022;browser</span><span 
class="aett-10x-x-109"> position</span><span 
class="aett-10x-x-109"> chr2:2298361-2305861&#x0022;</span>
<br class="fancyvrb" /><a 
 id="x1-11012r2"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [2]</span><span 
class="aett-10x-x-109"> &#x0022;track</span><span 
class="aett-10x-x-109"> type=bed</span><span 
class="aett-10x-x-109"> name=\&#x0022;mySample\&#x0022;</span><span 
class="aett-10x-x-109"> description=\&#x0022;qFDRP</span><span 
class="aett-10x-x-109"> scores</span><span 
class="aett-10x-x-109"> in</span><span 
class="aett-10x-x-109"> 7500</span><span 
class="aett-10x-x-109"> tiles\&#x0022;</span><span 
class="aett-10x-x-109"> useScore=1&#x0022;</span>
<br class="fancyvrb" /><a 
 id="x1-11014r3"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [3]</span><span 
class="aett-10x-x-109"> &#x0022;chr2</span><span 
class="aett-10x-x-109"> 2298361</span><span 
class="aett-10x-x-109"> 2305861</span><span 
class="aett-10x-x-109"> </span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">9%</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 8.76&#x0022;</span><br class="fancyvrb" /><a 
 id="x1-11016r4"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [4]</span><span 
class="aett-10x-x-109"> &#x0022;chr2</span><span 
class="aett-10x-x-109"> 2305861</span><span 
class="aett-10x-x-109"> 2313361</span><span 
class="aett-10x-x-109"> </span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">10%</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109"> 10.37&#x0022;</span>
<br class="fancyvrb" /><a 
 id="x1-11018r5"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [5]</span><span 
class="aett-10x-x-109"> &#x0022;chr2</span><span 
class="aett-10x-x-109"> 2313361</span><span 
class="aett-10x-x-109"> 2320861</span><span 
class="aett-10x-x-109"> </span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">10%</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 9.92&#x0022;</span><br class="fancyvrb" /><a 
 id="x1-11020r6"></a><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> [6]</span><span 
class="aett-10x-x-109"> &#x0022;chr2</span><span 
class="aett-10x-x-109"> 2320861</span><span 
class="aett-10x-x-109"> 2328361</span><span 
class="aett-10x-x-109"> </span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">10%</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109"> </span><span 
class="aett-10x-x-109"> 9.89&#x0022;</span></div>
 
</body></html> 

                                                                                       


